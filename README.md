# VST для микрофона в Windows
Отдельные плагины Шумоподавитель и Компрессор для микрофона с помощью EqualizerAPO на Windows

## Установка EqualizerAPO
1. Устанавливаем [EqualizerAPO](https://sourceforge.net/projects/equalizerapo) (после установки можно не перезапускаться)
2. Ставим APO на ваш микрофон
> [!tip]
> 1. В окне `Configurator.exe` > Вкладка "Capture devices" > Выбираем используемый вами микрофон.
> 2. После выбора нужно применить настройки к аудио службе. 
> 3. По умолчанию, приложение просит перезапуск пк, но это не обязательно. Можно лишь запустить, представленный в репозитории, батник перезапуска аудио службы: [`restart-audio-service.bat`](https://github.com/N3M1X10/VST/blob/master/src/restart-audio-service.bat)

3. Включаем мониторинг: Чтобы проверить - меняется ли звук микрофона в системе
> [!tip]
> 1. Сочетание клавиш "Win+R" в окне введите `control mmsys.cpl`
> 2. В окне "Звук" Выберите вкладку "Запись" > Выберите свой микрофон
> 3. Откройте "Cвойства" > Вкладка "Прослушать" > Установить галочку "Прослушать c данного устройства"
> 4. Выберите устройство воспроизведения, через которое будете слушать себя.
> 5. Открываем EqualizerAPO (`Editor.exe`) и ставим плагины как написано дальше, при включении - они должны менять звучание микрофона.

4. Добавляем плагины в APO:
>[!tip]
>**Плагины в текущем репозитории**
>- [`src/plugins`](https://github.com/N3M1X10/VST/blob/master/src/plugins)
>
>**Ссылки на актуальные версии плагинов**
>- [LoudMax](https://loudmax.blogspot.com)
>- [RNNoise (noise-suppression-for-voice)](https://github.com/werman/noise-suppression-for-voice/releases)

> [!tip]
> - Плагины (файлы `*.dll`) лучше всего поместить в папку с программой: `EqualizerAPO\VSTPlugins\`
> 1. Запускаем `Editor.exe`
> 2. Удаляем все имеющиеся там улучшения (понажимать минусы или Ctrl+A, Del)
> 3. Жмём "+" > "Plugins" > "VSTPlugins" 
> 4. Добавляем плагин LoudMax (Компрессор) для соответствующей разрядности системы
> 5. RNNoise (шумоподавитель) для соответствующего микрофона (однополосный, стереополосный)
> 6. Должно получиться 2 плашки с двумя плагинами

5. Настраиваем работу плагинов как вам угодно, под ваши уши, сидя с мониторингом (слушаем себя)

## Настройка плагинов

### Настройки LoudMax (своими словами)
- Threshold - верхний ползунок, это нижний порог усиления (так назвал для удобства), ниже которого - сигнал усиливаться не будет. 
- Out - нижний ползунок, определяет как ограничение (лимитер), так и эталонный уровень выходного сигнала (компрессор). 
То есть громче чем этот параметр звучать не получится (лимит). Также компрессор попытается выровнять звук под это значение, если ваш уровень громкости попадает под первый параметр (равен, либо выше - чем нижний порог усиления).

> Остальные параметры Loudmax вряд ли пригодятся обычному пользователю, за подробностями на [оф.сайт](https://loudmax.blogspot.com)


### Настройки RNNoise (взято с [Github данного плагина](https://github.com/werman/noise-suppression-for-voice?tab=readme-ov-file#plugin-settings))
- VAD Threshold (%) - если вероятность того, что звук является голосом, ниже этого порога - он будет заглушен. В большинстве случаев порог между 85% - 95% будет подходящим. Без VAD некоторые громкие шумы все еще могут быть немного слышны, когда нет голоса.
- VAD Grace Period (ms) - как долго после последнего обнаружения голоса вывод не будет заглушен. Это помогает, когда обрезаются концы слов/предложений.
- Retroactive VAD Grace Period (ms) - аналогично, VAD Grace Period но для начала слов/предложений. ⚠️Это приводит к задержке!


## Настройки в Discord
1. Переходим в Настройки -> Голос и видео
2. Чувствительность ввода -> Автоматически определять -> Выкл
3. Установить порог чувствительности так, чтобы когда вы говорите - индикатор всегда достигал зелёной зоны, и когда не говорите - наоборот
4. Шумоподавлене -> Пусто
5. Автоматическая регулировка усиления -> Выкл
6. Звуковая подсистема -> Авто

## Не устанавливается APO на микрофон
1. Запускаем `Configurator.exe`
2. Вкладка "Capture Devices" > Выбираем свой микрофон и ставим на нём галочку
3. Снизу ставим галочку на "Troubleshooting Options"
4. Перебором параметра "install as ..." начинаем проверять установку APO
> [!tip]
> 1. Выбираем любой параметр "install as ..."
> 2. "Pre-mix: [x] Install APO & [x] Use original APO" не меняем если галочки стоят
> 3. Нажимаем "OK"
> 4. Запускаем [`restart-audio-service.bat`](https://github.com/N3M1X10/VST/blob/master/src/restart-audio-service.bat)
> 5. Проверяем - меняется ли звук
5. В случае неудачи - повторяем все пункты но в "install as ..." меняем параметр на другой